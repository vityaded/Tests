<!-- templates/book_tests.html -->
{% extends "base.html" %}

{% block title %}Tests for {{ book.title }}{% endblock %}

{% block content %}
  <h1 class="my-4">Tests for "{{ book.title }}"</h1>
  <ul>
    {% for test in tests %}
      <li>
        <strong>{{ test.name }}</strong> 
        {% if test.time_limit %}
          - Time Limit: {{ test.time_limit }} minutes
        {% else %}
          - No Time Limit
        {% endif %}
        <div class="btn-group" role="group">
          <a href="{{ url_for('take_test', test_id=test.id) }}" class="btn btn-primary btn-sm">Take Test</a>
          {% if current_user.is_authenticated and (current_user.is_admin or test.created_by == current_user.id) %}
            <a href="{{ url_for('edit_test', test_id=test.id) }}" class="btn btn-secondary btn-sm">Edit</a>
            <form action="{{ url_for('delete_test', test_id=test.id) }}" method="post" style="display: inline;">
              <input type="hidden" name="csrf_token" value="{{ csrf_token }}"/>
              <button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('Are you sure you want to delete this test?');">Delete</button>
            </form>
          {% endif %}
        </div>
      </li>
    {% else %}
      <li>No tests available for this book.</li>
    {% endfor %}
  </ul>
  <a href="{{ url_for('index') }}" class="btn btn-link">Back to Home</a>
{% endblock %}
